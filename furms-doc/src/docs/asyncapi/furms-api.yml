asyncapi: 2.0.0
info:
   title: FURMS messaging API for site agents
   version: 1.0.0   
   description: Introduction to the Async API is available [here](./messaging-api-intro.html)
channels:
   site/site_id/project/provision/req:
      subscribe:
         summary: Provision a project to site
         description: Installation of a project on a site will happen when the first resource of the site is allocated to the project.
         operationId: ProjectInstallationRequest
         message:
            name: ProjectInstallationRequest
            traits:
               - $ref: "#/components/messageTraits/request"
            payload:
               type: object
               additionalProperties: false
               properties:
                  identifier:
                     type: string
                     description: generated by FURMS, unique, persistent
                  name:
                     type: string
                     description: project name
                  description:
                     type: string
                  acronym:
                     type: string
                  communityId:
                     type: string
                  community:
                     type: string
                  researchField:
                     type: string
                  validityStart:
                     type: string
                     format: dateTime
                  validityEnd:
                     type: string
                     format: dateTime
                  projectLeader:
                     $ref: "#/components/schemas/userRecord"
                     
   site/site_id/project/provision/ack:
      publish:
         summary: Acknowledge request
         operationId: ProjectInstallationRequestAck
         message:
            name: ProjectInstallationRequestAck
            traits:
               - $ref: "#/components/messageTraits/requestAck"
            payload:
               $ref: "#/components/schemas/emptyObject"

                                 
   site/site_id/project/provision/resp:
      publish:
         summary: Acknowledge project installation on site
         description: Site agents must send information to FURMS whenever a project is installed on a site or if project installation fails. 
         operationId: ProjectInstallationResult
         message:
            name: ProjectInstallationResult
            traits:
               - $ref: "#/components/messageTraits/response"
            payload:
               type: object
               additionalProperties: false
               properties:
                  attributes:
                     type: object
                     properties:
                        gid:
                           type: string
                           description: GID of the created group, not required in case of error


   site/site_id/project/removal/req:
      subscribe:
         summary: Remove a project from a site
         description: Project removal will be requested by FURMS when previously installed project lifetime ends.
         operationId: ProjectRemovalRequest
         message:
            name: ProjectRemovalRequest
            traits:
               - $ref: "#/components/messageTraits/request"
            payload:
               type: object
               additionalProperties: false
               properties:
                  identifier:
                     type: string
                     description: generated by FURMS, unique, persistent

   site/site_id/project/removal/ack:
      publish:
         summary: Acknowledge removal request
         operationId: ProjectRemovalRequestAck
         message:
            name: ProjectRemovalRequestAck
            traits:
               - $ref: "#/components/messageTraits/requestAck"
            payload:
               $ref: "#/components/schemas/emptyObject"


   site/site_id/project/removal/resp:
      publish:
         summary: Acknowledge project removal on a site
         description: Project removal or removal failure must be communicated to FURMS with the following message.
         operationId: ProjectRemovalResult
         message:
            name: ProjectRemovalResult
            traits:
               - $ref: "#/components/messageTraits/response"
            payload:
               $ref: "#/components/schemas/emptyObject"

   site/site_id/project/update/req:
      subscribe:
         summary: Update a project on a site
         description: Project metadata can change in FURMS. In such cases, a project update request will be sent to a site.
         operationId: ProjectUpdateRequest
         message:
            name: ProjectUpdateRequest
            traits:
               - $ref: "#/components/messageTraits/request"
            payload:
               type: object
               additionalProperties: false
               properties:
                  identifier:
                     type: string
                     description: generated by FURMS, unique, persistent
                  name:
                     type: string
                     description: project name
                  description:
                     type: string
                  researchField:
                     type: string
                  acronym:
                     type: string
                  validityStart:
                     type: string
                     format: dateTime
                  validityEnd:
                     type: string
                     format: dateTime
                  projectLeader:
                     $ref: "#/components/schemas/userRecord"
                                 
   site/site_id/project/update/ack:
      publish:
         summary: Acknowledge update request
         operationId: ProjectUpdateRequestAck
         message:
            name: ProjectUpdateRequestAck
            traits:
               - $ref: "#/components/messageTraits/requestAck"
            payload:
               $ref: "#/components/schemas/emptyObject"

            
   site/site_id/project/update/resp:
      publish:
         summary: Acknowledge project update on site
         description: Site agents must send information to FURMS whenever the project is updated or if the project update fails.  
         operationId: ProjectUpdateResult
         message:
            name: ProjectUpdateResult
            traits:
               - $ref: "#/components/messageTraits/response"
            payload:
               $ref: "#/components/schemas/emptyObject"

   site/site_id/user/status/req:
      subscribe:
         summary: Suspend/enable user on site
         description: Shall be used by FURMS to signal the site that user access to the site should be suspended or re-enabled.
         operationId: SetUserStatusRequest
         message:
            name: SetUserStatusRequest
            traits:
               - $ref: "#/components/messageTraits/request"
            payload:
               type: object
               additionalProperties: false
               properties:
                  fenixUserId:
                     $ref: "#/components/schemas/fenixUserId"
                  status:
                     type: string
                     enum:
                        - ENABLED
                        - DISABLED
                  reason:
                     type: string
                     enum:
                        - security_incident

   site/site_id/user/status/ack:
      publish:
         summary: Acknowledge status update request
         operationId: SetUserStatusRequestAck
         message:
            name: SetUserStatusRequestAck
            traits:
               - $ref: "#/components/messageTraits/requestAck"
            payload:
               $ref: "#/components/schemas/emptyObject"

            
   site/site_id/user/status/resp:
      publish:
         summary: Acknowledge user status change on a site
         operationId: SetUserStatusResult
         message:
            name: SetUserStatusResult
            traits:
               - $ref: "#/components/messageTraits/response"
            payload:
               $ref: "#/components/schemas/emptyObject"


   site/site_id/sshkey/add/req:
      subscribe:
         summary: Install user's SSH key
         description: Is used to request SSH key installation on a site
         operationId: UserSSHKeyAddRequest
         message:
            name: UserSSHKeyAddRequest
            traits:
               - $ref: "#/components/messageTraits/request"
            payload:
               type: object
               additionalProperties: false
               properties:
                  fenixUserId:
                     $ref: "#/components/schemas/fenixUserId"
                  publicKey:
                     type: string

   site/site_id/sshkey/add/ack:
      publish:
         summary: Acknowledge SSH key add request
         operationId: UserSSHKeyAddRequestAck
         message:
            name: UserSSHKeyAddRequestAck
            traits:
               - $ref: "#/components/messageTraits/requestAck"
            payload:
               $ref: "#/components/schemas/emptyObject"

            
   site/site_id/sshkey/add/resp:
      publish:
         summary: Acknowledge adding SSH key
         operationId: UserSSHKeyAddResult
         message:
            name: UserSSHKeyAddResult
            traits:
               - $ref: "#/components/messageTraits/response"
            payload:
               $ref: "#/components/schemas/emptyObject"

   site/site_id/sshkey/update/req:
      subscribe:
         summary: Update user's SSH key
         description: Is used to request SSH key update on a site
         operationId: UserSSHKeyUpdateRequest
         message:
            name: UserSSHKeyUpdateRequest
            traits:
               - $ref: "#/components/messageTraits/request"
            payload:
               type: object
               additionalProperties: false
               properties:
                  fenixUserId:
                     $ref: "#/components/schemas/fenixUserId"
                  oldPublicKey:
                     type: string
                  newPublicKey:
                     type: string

   site/site_id/sshkey/update/ack:
      publish:
         summary: Acknowledge SSH key update request
         operationId: UserSSHKeyUpdateRequestAck
         message:
            name: UserSSHKeyUpdateRequestAck
            traits:
               - $ref: "#/components/messageTraits/requestAck"
            payload:
               $ref: "#/components/schemas/emptyObject"

            
   site/site_id/sshkey/update/resp:
      publish:
         summary: Acknowledge updating SSH key
         operationId: UserSSHKeyUpdateResult
         message:
            name: UserSSHKeyUpdateResult
            traits:
               - $ref: "#/components/messageTraits/response"
            payload:
               $ref: "#/components/schemas/emptyObject"
   
   
   site/site_id/sshkey/remove/req:
      subscribe:
         summary: Remove user's SSH key
         description: Used to request SSH key removal on a site
         operationId: UserSSHKeyRemovalRequest
         message:
            name: UserSSHKeyRemovalRequest
            traits:
               - $ref: "#/components/messageTraits/request"
            payload:
               type: object
               additionalProperties: false
               properties:
                  fenixUserId:
                     $ref: "#/components/schemas/fenixUserId"
                  publicKey:
                     type: string

   site/site_id/sshkey/remove/ack:
      publish:
         summary: Acknowledge SSH key removal request
         operationId: UserSSHKeyRemovalRequestAck
         message:
            name: UserSSHKeyRemovalRequestAck
            traits:
               - $ref: "#/components/messageTraits/requestAck"
            payload:
               $ref: "#/components/schemas/emptyObject"

            
   site/site_id/sshkey/remove/resp:
      publish:
         summary: Acknowledge adding SSH key
         operationId: UserSSHKeyRemovalResult
         message:
            name: UserSSHKeyRemovalResult
            traits:
               - $ref: "#/components/messageTraits/response"
            payload:
               $ref: "#/components/schemas/emptyObject"



   site/site_id/project/user_add/req:
      subscribe:
         summary: Add user to a project
         description: Sent by FURMS to request adding a user to a project.
         operationId: UserProjectAddRequest
         message:
            name: UserProjectAddRequest
            traits:
               - $ref: "#/components/messageTraits/request"
            payload:
               type: object
               additionalProperties: false
               properties:
                  user:
                     $ref: "#/components/schemas/userRecord"
                  policiesAcceptance:
                     type: array
                     items:
                        type: object
                        additionalProperties: false
                        properties:
                           policyIdentifier:
                              type: string
                           currentVersion:
                              type: number
                              format: integer
                           serviceIdentifier:
                              type: string
                              description: only for service policies
                           processedVersion:
                              type: number
                              format: integer
                           acceptance:
                              type: string
                              enum:
                                 - ACCEPTED
                                 - REJECTED
                                 - UNKNOWN
                  projectIdentifier:
                     $ref: "#/components/schemas/projectIdentifier"

   site/site_id/project/user_add/ack:
      publish:
         summary: Acknowledge user add to project request
         operationId: UserProjectAddRequestAck
         message:
            name: UserProjectAddRequestAck
            traits:
               - $ref: "#/components/messageTraits/requestAck"
            payload:
               $ref: "#/components/schemas/emptyObject"

            
   site/site_id/project/user_add/resp:
      publish:
         summary: User to project add result
         description: Should be sent by the site agent to indicate user addition (or failure of) to a project. 
         operationId: UserProjectAddResult
         message:
            name: UserProjectAddResult
            traits:
               - $ref: "#/components/messageTraits/response"
            payload:
               type: object
               additionalProperties: false
               properties:
                  uid:
                     $ref: "#/components/schemas/uid"


   site/site_id/project/user_remove/req:
      subscribe:
         summary: Remove user from a project
         description: Should be sent by FURMS to request removal of a user from a project.
         operationId: UserProjectRemovalRequest
         message:
            name: UserProjectRemovalRequest
            traits:
               - $ref: "#/components/messageTraits/request"
            payload:
               type: object
               additionalProperties: false
               properties:
                  fenixUserId:
                     $ref: "#/components/schemas/fenixUserId"
                  projectIdentifier:
                     $ref: "#/components/schemas/projectIdentifier"

   site/site_id/project/user_remove/ack:
      publish:
         summary: Acknowledge user removal from project request
         operationId: UserProjectRemovalRequestAck
         message:
            name: UserProjectRemovalRequestAck
            traits:
               - $ref: "#/components/messageTraits/requestAck"
            payload:
               $ref: "#/components/schemas/emptyObject"
            
   site/site_id/project/user_remove/resp:
      publish:
         summary: User removal from project result 
         description: Should be sent by the site agent when a user was removed from a project or removal failed.
         operationId: UserProjectRemovalResult
         message:
            name: UserProjectRemovalResult
            traits:
               - $ref: "#/components/messageTraits/response"
            payload:
               $ref: "#/components/schemas/emptyObject"





   site/site_id/resource/allocate/req:
      subscribe:
         summary: Request resource allocation to a project
         description: Will be sent by FURMS to inform the site that part of resource credit defined by the site admin in FURMS was allocated to a (previously provisioned) project. Note that this may be either an initial allocation or an update of the allocation. In the latter case the allocationIdentifier parameter should be already known to the site.
         operationId: ProjectResourceAllocationRequest
         message:
            name: ProjectResourceAllocationRequest
            traits:
               - $ref: "#/components/messageTraits/request"
            payload:
               type: object
               additionalProperties: false
               properties:
                  projectIdentifier:
                     $ref: "#/components/schemas/projectIdentifier"
                  allocationIdentifier:
                     $ref: "#/components/schemas/allocationIdentifier"  
                  resourceCreditIdentifier:
                     type: string
                     description: Can be used to correlate the request with resource credit as configured in FURMS by site admin. 
                  resourceType:
                     type: string
                  amount:
                     type: number
                     format: double
                  validFrom:
                     type: string
                     format: dateTime
                  validTo: 
                     type: string
                     format: dateTime

   site/site_id/resource/allocate/ack:
      publish:
         summary: Acknowledge allocate resource to a project request
         operationId: ProjectResourceAllocationRequestAck
         message:
            name: ProjectResourceAllocationRequestAck
            traits:
               - $ref: "#/components/messageTraits/requestAck"
            payload:
               $ref: "#/components/schemas/emptyObject"
            
   site/site_id/resource/allocate/resp:
      publish:
         summary: Information about allocated resources
         description: In case when a request is generally accepted, the site should actually allocate resources. Since the allocation scheme can vary from site to site, the site agent can report multiple allocations, with different amounts then the requested ones. Reporting of allocation is communicated with the message ResourceAllocationResult
         operationId: ProjectResourceAllocationResult
         message:
            name: ProjectResourceAllocationResult
            traits:
               - $ref: "#/components/messageTraits/response"
            payload:
               type: object
               additionalProperties: false
               properties:
                  allocationIdentifier:
                     $ref: "#/components/schemas/allocationIdentifier"
                  allocationChunkIdentifier:
                     type: string
                     description: Identifies chunk assigned by site under the requested allocationIdentifier. Single FURMS allocation can be realized with multiple chunks.  
                  amount:
                     type: number
                     format: double
                  validFrom:
                     type: string
                     format: dateTime
                  validTo: 
                     type: string
                     format: dateTime


   site/site_id/resource/allocate/update:
      publish:
         summary: Update of allocated resources
         description: Carries an update of a previously sent allocation with the ResourceAllocationResult message.
         operationId: ProjectResourceAllocationUpdate
         message:
            name: ProjectResourceAllocationUpdate
            traits:
               - $ref: "#/components/messageTraits/response"
            payload:
               type: object
               additionalProperties: false
               properties:
                  allocationIdentifier:
                     $ref: "#/components/schemas/allocationIdentifier"
                  allocationChunkIdentifier:
                     type: string
                     description: Identifies the updated chunk.  
                  amount:
                     type: number
                     format: double
                  validFrom:
                     type: string
                     format: dateTime
                  validTo: 
                     type: string
                     format: dateTime


   site/site_id/resource/deallocate/req:
      subscribe:
         summary: Remove resource allocation from a project
         description: Will be sent by FURMS to inform the site that a formerly allocated resource allocation was removed from a project
         operationId: ProjectResourceDeallocationRequest
         message:
            name: ProjectResourceDeallocationRequest
            traits:
               - $ref: "#/components/messageTraits/request"
            payload:
               type: object
               additionalProperties: false
               properties:
                  projectIdentifier:
                     $ref: "#/components/schemas/projectIdentifier"
                  allocationIdentifier:
                     $ref: "#/components/schemas/allocationIdentifier"  
                  resourceCreditIdentifier:
                     type: string
                  resourceType:
                     type: string


   site/site_id/resource/deallocate/ack:
      publish:
         summary: Acknowledge deallocation request
         operationId: ProjectResourceDeallocationRequestAck
         message:
            name: ProjectResourceDeallocationRequestAck
            traits:
               - $ref: "#/components/messageTraits/requestAck"
            payload:
               $ref: "#/components/schemas/emptyObject"



   site/site_id/allocation/user_add/req:
      subscribe:
         summary: Request to grant user access to allocation
         description: Sent by FURMS to request granting user rights to an allocation within a project.
         operationId: UserAllocationGrantAccessRequest
         message:
            name: UserAllocationGrantAccessRequest
            traits:
               - $ref: "#/components/messageTraits/request"
            payload:
               type: object
               additionalProperties: false
               properties:
                  allocationIdentifier:
                     $ref: "#/components/schemas/allocationIdentifier"
                  user:
                     $ref: "#/components/schemas/userRecord"
                  projectIdentifier:
                     $ref: "#/components/schemas/projectIdentifier"
                  policiesAcceptance:
                     $ref: "#/components/schemas/policiesAcceptance"
                  

   site/site_id/allocation/user_add/ack:
      publish:
         summary: Acknowledge grant user access to allocation request
         operationId: UserAllocationGrantAccessRequestAck
         message:
            name: UserAllocationGrantAccessRequestAck
            traits:
               - $ref: "#/components/messageTraits/requestAck"
            payload:
               $ref: "#/components/schemas/emptyObject"
            
   site/site_id/allocation/user_add/resp:
      publish:
         summary: Grant user access to allocation
         description: Should be sent by the site agent to indicate granting user access to allocation. 
         operationId: UserAllocationGrantAccessResult
         message:
            name: UserAllocationGrantAccessResult
            traits:
               - $ref: "#/components/messageTraits/response"
            payload:
               $ref: "#/components/schemas/emptyObject"



   site/site_id/allocation/user_remove/req:
      subscribe:
         summary: Request removal of user's access to allocation
         description: Sent by FURMS to request removing the previously granted access to an allocation for a user.
         operationId: UserAllocationBlockAccessRequest
         message:
            name: UserAllocationBlockAccessRequest
            traits:
               - $ref: "#/components/messageTraits/request"
            payload:
               type: object
               additionalProperties: false
               properties:
                  allocationIdentifier:
                     $ref: "#/components/schemas/allocationIdentifier"
                  fenixUserId:
                     $ref: "#/components/schemas/fenixUserId"
                  projectIdentifier:
                     $ref: "#/components/schemas/projectIdentifier"

   site/site_id/allocation/user_remove/ack:
      publish:
         summary: Acknowledge remove user's access to allocation request
         operationId: UserAllocationBlockAccessRequestAck
         message:
            name: UserAllocationBlockAccessRequestAck
            traits:
               - $ref: "#/components/messageTraits/requestAck"
            payload:
               $ref: "#/components/schemas/emptyObject"
            
   site/site_id/allocation/user_remove/resp:
      publish:
         summary: Signal removal of user's access to allocation
         description: Should be sent by the site agent to indicate that user's access to an allocation was blocked.
         operationId: UserAllocationBlockAccessResult
         message:
            name: UserAllocationBlockAccessResult
            traits:
               - $ref: "#/components/messageTraits/response"
            payload:
               $ref: "#/components/schemas/emptyObject"


   site/site_id/resource_usage/cumulative:
      publish:
         summary: Cumulative allocation usage record
         description: Sent from the site agent to FURMS to report per-project and allocation resource consumption.
         operationId: CumulativeResourceUsageRecord
         message:
            name: CumulativeResourceUsageRecord
            traits:
               - $ref: "#/components/messageTraits/oneWay"
            payload:
               type: object
               additionalProperties: false
               properties:
                  projectIdentifier:
                     $ref: "#/components/schemas/projectIdentifier"
                  allocationIdentifier:
                     $ref: "#/components/schemas/allocationIdentifier"
                  cumulativeConsumption:
                     type: number
                     format: double
                  probedAt:
                     type: string
                     format: dateTime

   site/site_id/resource_usage/user:
      publish:
         summary: Per-user allocation usage record
         description: Sent from the site agent to FURMS to report per-project, user and allocation resource consumption.
         operationId: UserResourceUsageRecord
         message:
            name: UserResourceUsageRecord
            traits:
               - $ref: "#/components/messageTraits/oneWay"
            payload:
               type: object
               additionalProperties: false
               properties:
                  projectIdentifier:
                     $ref: "#/components/schemas/projectIdentifier"
                  allocationIdentifier:
                     $ref: "#/components/schemas/allocationIdentifier"
                  fenixUserId:
                     $ref: "#/components/schemas/fenixUserId"
                  cumulativeConsumption:
                     type: number
                     format: double
                  consumedUntil:
                     type: string
                     format: dateTime

   site/site_id/error/info:
      subscribe:
         summary: Error info callback
         description: Sent from FURMS to site agent to report message handling errors.
         operationId: AgentMessageErrorInfo
         message:
            name: AgentMessageErrorInfo
            traits:
               - $ref: "#/components/messageTraits/oneWay"
            payload:
               type: object
               additionalProperties: false
               properties:
                  correlationId:
                     type: string
                     description: Correlation id of the problematic message
                  errorType:
                     type: string
                     enum:
                        - InvalidMessageContent
                        - InvalidSiteId
                        - InvalidCorrelationId
                        - IllegalStateTransition
                        - IllegalArgument
                        - UnsupportedFailedChunk
                     description: Type of problem
                  description:
                     type: string
                     description: Human readable description

   site/site_id/ping/req:
      subscribe:
         summary: Ping agent
         description: Used by FURMS to check if the site agent is on-line. The request has an empty body, and RequestAck is used to determine availability.
         operationId: AgentPingRequest
         message:
            name: AgentPingRequest
            traits:
               - $ref: "#/components/messageTraits/request"
            payload:
               $ref: "#/components/schemas/emptyObject"

   site/site_id/ping/ack:
      publish:
         summary: Acknowledge ping request
         operationId: AgentPingRequestAck
         message:
            name: AgentPingRequestAck
            traits:
               - $ref: "#/components/messageTraits/requestAck"
            payload:
               $ref: "#/components/schemas/emptyObject"


   site/site_id/policy/acceptance_update:
      subscribe:
         summary: Policy acceptance update
         description: Used by FURMS to inform site agent that user's policies acceptance status has been changed.
         operationId: UserPolicyAcceptanceUpdate
         message:
            name: UserPolicyAcceptanceUpdate
            traits:
               - $ref: "#/components/messageTraits/oneWay"
            payload:
               type: object
               additionalProperties: false
               properties:
                  fenixUserId:
                     $ref: "#/components/schemas/fenixUserId"
                  policiesAcceptance:
                     $ref: "#/components/schemas/policiesAcceptance"

   site/site_id/policy/acceptance_update/ack:
      publish:
         summary: Acknowledge acceptance update request
         operationId: UserPolicyAcceptanceUpdateAck
         message:
            name: UserPolicyAcceptanceUpdateAck
            traits:
               - $ref: "#/components/messageTraits/requestAck"
            payload:
               $ref: "#/components/schemas/emptyObject"

   site/site_id/policy/update:
      subscribe:
         summary: Policy document update
         description: Used by FURMS to inform site agent that a policy has been updated
         operationId: PolicyUpdate
         message:
            name: PolicyUpdate
            traits:
               - $ref: "#/components/messageTraits/oneWay"
            payload:
               type: object
               additionalProperties: false
               properties:
                  policyIdentifier:
                     type: string
                  policyName:
                     type: string
                  currentVersion:
                     type: integer
                  serviceIdentifier:
                     type: string
                     description: only used for service policies

   site/site_id/policy/update/ack:
      publish:
         summary: Acknowledge policy update request
         operationId: PolicyUpdateAck
         message:
            name: PolicyUpdateAck
            traits:
               - $ref: "#/components/messageTraits/requestAck"
            payload:
               $ref: "#/components/schemas/emptyObject"

components:
   messageTraits:
      request:
         headers:
            type: object
            additionalProperties: false
            properties:
               version:
                  type: integer
                  default: 1
               messageCorrelationId:
                  type: string
      response:
         headers:
            $ref: "#/components/schemas/responseMeta"
            
      requestAck:
         headers:
            $ref: "#/components/schemas/responseMeta"

      oneWay:
         headers:
            type: object
            additionalProperties: false
            properties:
               version:
                  type: integer
                  default: 1
            
   messages:
      requestAck:
         name: requestAck
         headers:
            $ref: "#/components/schemas/responseMeta"
         payload:
            type: object
            additionalProperties: false
            
                    
   schemas:
      uid:
         type: string
         description: Local site-assigned account id aka Unix user id.
      allocationIdentifier:
         type: string
         description: FURMS assigned, unique identifier of a particular project allocation. Single resource credit can have many allocations. 
      fenixUserId:
         type: string
         description: Fenix-wide identifier of a person, managed by Fenix Central IdP
      projectIdentifier:
         type: string
         description: FURMS assigned, unique identifier of a project.
      
      responseMeta:
         type: object
         additionalProperties: false
         properties: 
            version:
               type: integer
               default: 1
            messageCorrelationId:
               type: string
            status:
               type: string
               enum:
                  - OK
                  - FAILED
            error: 
               type: object
               description: optional, only present if status=FAILED
               additionalProperties: false
               properties:
                  code:
                     type: string
                  message:
                     type: string

      emptyObject:
         type: object
         additionalProperties: false
                  
      userRecord:
         type: object
         additionalProperties: false
         properties:
            fenixUserId:
               $ref: "#/components/schemas/fenixUserId"
            title:
               type: string
            firstName:
               type: string
            lastName:
               type: string
            gender:
               type: string
            nationality:
               type: string
            email:
               type: string
            phone:
               type: string
            placeOfBirth:
               type: string
            dateOfBirth:
               type: string
               format: date         
            organizationName:
               type: string
            organizationAddress:
               type: string
            organizationPostalCode:
               type: string
            organizationCountry:
               type: string
            organizationPhone:
               type: string
            homeAddress:
               type: string
            homePostalCode:
               type: string
            homeCountry:
               type: string
      
      policyAcceptanceContent:
         type: object
         additionalProperties: false
         properties:
            policyIdentifier:
               type: string
            currentVersion:
               type: integer
            serviceIdentifier:
               type: string
               description: only used for service policies
            processedVersion:
               type: integer
            acceptance:
               type: string
               enum:
                  - REJECTED
                  - ACCEPTED
                  - UNKNOWN
        
      policyAcceptance:
         type: object
         additionalProperties: false
         properties:
            policyAcceptance:
                 $ref: "#/components/schemas/policyAcceptanceContent"
                 
      policiesAcceptance:
         type: array
         items:
            $ref: "#/components/schemas/policyAcceptance"
                 

externalDocs:  
   description: Introduction to the Async API is available here
   url: https://unity-idm.github.io/furms/current-head/messaging-api-intro.html